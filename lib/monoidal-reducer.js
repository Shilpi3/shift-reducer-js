"use strict";

var MonoidalReducer = (function () {
  var MonoidalReducer = function MonoidalReducer(monoid) {
    var empty = monoid.empty();
    this.identity = function () {
      return empty;
    };
    var concat = monoid.prototype && monoid.prototype.concat || monoid.concat;
    this.append = this.append2 = function (a, b) {
      return concat.call(a, b);
    };
  };

  MonoidalReducer.prototype.fromNull = function (a) {
    return a == null ? this.identity() : a;
  };

  MonoidalReducer.prototype.append3 = function (a, b, c) {
    return this.append(this.append(a, b), c);
  };

  MonoidalReducer.prototype.append4 = function (a, b, c, d) {
    return this.append(this.append3(a, b, c), d);
  };

  MonoidalReducer.prototype.fold = function (as, a) {
    var _this = this;
    return as.reduce(function (memo, x) {
      return _this.append(memo, x);
    }, a == null ? this.identity() : a);
  };

  MonoidalReducer.prototype.reduceArrayExpression = function (node, elements) {
    return this.fold(elements.filter(function (x) {
      return x != null;
    }));
  };

  MonoidalReducer.prototype.reduceAssignmentExpression = function (node, binding, expression) {
    return this.append(binding, expression);
  };

  MonoidalReducer.prototype.reduceBinaryExpression = function (node, left, right) {
    return this.append(left, right);
  };

  MonoidalReducer.prototype.reduceBlock = function (node, statements) {
    return this.fold(statements);
  };

  MonoidalReducer.prototype.reduceBlockStatement = function (node, block) {
    return block;
  };

  MonoidalReducer.prototype.reduceBreakStatement = function (node, label) {
    return this.fromNull(label);
  };

  MonoidalReducer.prototype.reduceCallExpression = function (node, callee, args) {
    return this.fold(args, callee);
  };

  MonoidalReducer.prototype.reduceCatchClause = function (node, binding, body) {
    return this.append(binding, body);
  };

  MonoidalReducer.prototype.reduceComputedMemberExpression = function (node, object, expression) {
    return this.append(object, expression);
  };

  MonoidalReducer.prototype.reduceConditionalExpression = function (node, test, consequent, alternate) {
    return this.append3(test, consequent, alternate);
  };

  MonoidalReducer.prototype.reduceContinueStatement = function (node, label) {
    return this.fromNull(label);
  };

  MonoidalReducer.prototype.reduceDataProperty = function (node, name, expression) {
    return this.append(name, expression);
  };

  MonoidalReducer.prototype.reduceDebuggerStatement = function (node) {
    return this.identity();
  };

  MonoidalReducer.prototype.reduceDoWhileStatement = function (node, body, test) {
    return this.append(body, test);
  };

  MonoidalReducer.prototype.reduceEmptyStatement = function (node) {
    return this.identity();
  };

  MonoidalReducer.prototype.reduceExpressionStatement = function (node, expression) {
    return expression;
  };

  MonoidalReducer.prototype.reduceForInStatement = function (node, left, right, body) {
    return this.append3(left, right, body);
  };

  MonoidalReducer.prototype.reduceForStatement = function (node, init, test, update, body) {
    return this.append4(this.fromNull(init), this.fromNull(test), this.fromNull(update), body);
  };

  MonoidalReducer.prototype.reduceFunctionBody = function (node, directives, statements) {
    return this.append(this.fold(directives), this.fold(statements));
  };

  MonoidalReducer.prototype.reduceFunctionDeclaration = function (node, name, parameters, body) {
    return this.append(this.fold(parameters, name), body);
  };

  MonoidalReducer.prototype.reduceFunctionExpression = function (node, name, parameters, body) {
    return this.append(this.fold(parameters, this.fromNull(name)), body);
  };

  MonoidalReducer.prototype.reduceGetter = function (node, name, body) {
    return this.append(name, body);
  };

  MonoidalReducer.prototype.reduceIdentifier = function (node) {
    return this.identity();
  };

  MonoidalReducer.prototype.reduceIdentifierExpression = function (node, name) {
    return name;
  };

  MonoidalReducer.prototype.reduceIfStatement = function (node, test, consequent, alternate) {
    return this.append3(test, consequent, this.fromNull(alternate));
  };

  MonoidalReducer.prototype.reduceLabeledStatement = function (node, label, body) {
    return this.append(label, body);
  };

  MonoidalReducer.prototype.reduceLiteralBooleanExpression = function (node) {
    return this.identity();
  };

  MonoidalReducer.prototype.reduceLiteralNullExpression = function (node) {
    return this.identity();
  };

  MonoidalReducer.prototype.reduceLiteralNumericExpression = function (node) {
    return this.identity();
  };

  MonoidalReducer.prototype.reduceLiteralRegExpExpression = function (node) {
    return this.identity();
  };

  MonoidalReducer.prototype.reduceLiteralStringExpression = function (node) {
    return this.identity();
  };

  MonoidalReducer.prototype.reduceNewExpression = function (node, callee, args) {
    return this.fold(args, callee);
  };

  MonoidalReducer.prototype.reduceObjectExpression = function (node, properties) {
    return this.fold(properties);
  };

  MonoidalReducer.prototype.reducePostfixExpression = function (node, operand) {
    return operand;
  };

  MonoidalReducer.prototype.reducePrefixExpression = function (node, operand) {
    return operand;
  };

  MonoidalReducer.prototype.reducePropertyName = function (node) {
    return this.identity();
  };

  MonoidalReducer.prototype.reduceReturnStatement = function (node, expression) {
    return this.fromNull(expression);
  };

  MonoidalReducer.prototype.reduceScript = function (node, body) {
    return body;
  };

  MonoidalReducer.prototype.reduceSetter = function (node, name, parameter, body) {
    return this.append3(name, parameter, body);
  };

  MonoidalReducer.prototype.reduceStaticMemberExpression = function (node, object, property) {
    return this.append(object, property);
  };

  MonoidalReducer.prototype.reduceSwitchCase = function (node, test, consequent) {
    return this.fold(consequent, test);
  };

  MonoidalReducer.prototype.reduceSwitchDefault = function (node, consequent) {
    return this.fold(consequent);
  };

  MonoidalReducer.prototype.reduceSwitchStatement = function (node, discriminant, cases) {
    return this.fold(cases, discriminant);
  };

  MonoidalReducer.prototype.reduceSwitchStatementWithDefault = function (node, discriminant, preDefaultCases, defaultCase, postDefaultCases) {
    return this.append4(discriminant, this.fold(preDefaultCases), defaultCase, this.fold(postDefaultCases));
  };

  MonoidalReducer.prototype.reduceThisExpression = function (node) {
    return this.identity();
  };

  MonoidalReducer.prototype.reduceThrowStatement = function (node, expression) {
    return this.fromNull(expression);
  };

  MonoidalReducer.prototype.reduceTryCatchStatement = function (node, block, catchClause) {
    return this.append(block, catchClause);
  };

  MonoidalReducer.prototype.reduceTryFinallyStatement = function (node, block, catchClause, finalizer) {
    return this.append3(block, this.fromNull(catchClause), finalizer);
  };

  MonoidalReducer.prototype.reduceUnknownDirective = function (node) {
    return this.identity();
  };

  MonoidalReducer.prototype.reduceUseStrictDirective = function (node) {
    return this.identity();
  };

  MonoidalReducer.prototype.reduceVariableDeclaration = function (node, declarators) {
    return this.fold(declarators);
  };

  MonoidalReducer.prototype.reduceVariableDeclarationStatement = function (node, declaration) {
    return declaration;
  };

  MonoidalReducer.prototype.reduceVariableDeclarator = function (node, binding, init) {
    return this.append(binding, this.fromNull(init));
  };

  MonoidalReducer.prototype.reduceWhileStatement = function (node, test, body) {
    return this.append(test, body);
  };

  MonoidalReducer.prototype.reduceWithStatement = function (node, object, body) {
    return this.append(object, body);
  };

  return MonoidalReducer;
})();

exports["default"] = MonoidalReducer;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9tb25vaWRhbC1yZWR1Y2VyLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0lBZ0JxQixlQUFlO01BQWYsZUFBZSxHQUN2QixTQURRLGVBQWUsQ0FDdEIsTUFBTSxFQUFFO0FBQ2xCLFFBQUksS0FBSyxHQUFHLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQztBQUMzQixRQUFJLENBQUMsUUFBUSxHQUFHO2FBQU0sS0FBSztLQUFBLENBQUM7QUFDNUIsUUFBSSxNQUFNLEdBQUcsTUFBTSxDQUFDLFNBQVMsSUFBSSxNQUFNLENBQUMsU0FBUyxDQUFDLE1BQU0sSUFBSSxNQUFNLENBQUMsTUFBTSxDQUFDO0FBQzFFLFFBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLE9BQU8sR0FBRyxVQUFDLENBQUMsRUFBRSxDQUFDO2FBQUssTUFBTSxDQUFDLElBQUksQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDO0tBQUEsQ0FBQztHQUMxRDs7QUFOa0IsaUJBQWUsV0FRbEMsUUFBUSxHQUFBLFVBQUMsQ0FBQyxFQUFFO0FBQ1YsV0FBTyxDQUFDLElBQUksSUFBSSxHQUFHLElBQUksQ0FBQyxRQUFRLEVBQUUsR0FBRyxDQUFDLENBQUM7R0FDeEM7O0FBVmtCLGlCQUFlLFdBV2xDLE9BQU8sR0FBQSxVQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFO0FBQ2YsV0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO0dBQzFDOztBQWJrQixpQkFBZSxXQWNsQyxPQUFPLEdBQUEsVUFBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUU7QUFDbEIsV0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztHQUM5Qzs7QUFo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LFFBQVEsRUFBRSxDQUFDO0dBQ3hCOztBQTFLa0IsaUJBQWUsV0EyS2xDLHlCQUF5QixHQUFBLFVBQUMsSUFBSSxFQUFFLFdBQVcsRUFBRTtBQUMzQyxXQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7R0FDL0I7O0FBN0trQixpQkFBZSxXQThLbEMsa0NBQWtDLEdBQUEsVUFBQyxJQUFJLEVBQUUsV0FBVyxFQUFFO0FBQ3BELFdBQU8sV0FBVyxDQUFDO0dBQ3BCOztBQWhMa0IsaUJBQWUsV0FpTGxDLHdCQUF3QixHQUFBLFVBQUMsSUFBSSxFQUFFLE9BQU8sRUFBRSxJQUFJLEVBQUU7QUFDNUMsV0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7R0FDbEQ7O0FBbkxrQixpQkFBZSxXQW9MbEMsb0JBQW9CLEdBQUEsVUFBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRTtBQUNyQyxXQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDO0dBQ2hDOztBQXRMa0IsaUJBQWUsV0F1TGxDLG1CQUFtQixHQUFBLFVBQUMsSUFBSSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUU7QUFDdEMsV0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sRUFBRSxJQUFJLENBQUMsQ0FBQztHQUNsQzs7U0F6TGtCLGVBQWU7OztxQkFBZixlQUFlIiwiZmlsZSI6InNyYy9tb25vaWRhbC1yZWR1Y2VyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgMjAxNCBTaGFwZSBTZWN1cml0eSwgSW5jLlxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIilcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1vbm9pZGFsUmVkdWNlciB7XG4gIGNvbnN0cnVjdG9yKG1vbm9pZCkge1xuICAgIGxldCBlbXB0eSA9IG1vbm9pZC5lbXB0eSgpO1xuICAgIHRoaXMuaWRlbnRpdHkgPSAoKSA9PiBlbXB0eTtcbiAgICBsZXQgY29uY2F0ID0gbW9ub2lkLnByb3RvdHlwZSAmJiBtb25vaWQucHJvdG90eXBlLmNvbmNhdCB8fCBtb25vaWQuY29uY2F0O1xuICAgIHRoaXMuYXBwZW5kID0gdGhpcy5hcHBlbmQyID0gKGEsIGIpID0+IGNvbmNhdC5jYWxsKGEsIGIpO1xuICB9XG5cbiAgZnJvbU51bGwoYSkge1xuICAgIHJldHVybiBhID09IG51bGwgPyB0aGlzLmlkZW50aXR5KCkgOiBhO1xuICB9XG4gIGFwcGVuZDMoYSwgYiwgYykge1xuICAgIHJldHVybiB0aGlzLmFwcGVuZCh0aGlzLmFwcGVuZChhLCBiKSwgYyk7XG4gIH1cbiAgYXBwZW5kNChhLCBiLCBjLCBkKSB7XG4gICAgcmV0dXJuIHRoaXMuYXBwZW5kKHRoaXMuYXBwZW5kMyhhLCBiLCBjKSwgZCk7XG4gIH1cbiAgZm9sZChhcywgYSkge1xuICAgIHJldHVybiBhcy5yZWR1Y2UoKG1lbW8sIHgpID0+IHRoaXMuYXBwZW5kKG1lbW8sIHgpLCBhID09IG51bGwgPyB0aGlzLmlkZW50aXR5KCkgOiBhKTtcbiAgfVxuXG4gIHJlZHVjZUFycmF5RXhwcmVzc2lvbihub2RlLCBlbGVtZW50cykge1xuICAgIHJldHVybiB0aGlzLmZvbGQoZWxlbWVudHMuZmlsdGVyKCh4KSA9PiB4ICE9IG51bGwpKTtcbiAgfVxuICByZWR1Y2VBc3NpZ25tZW50RXhwcmVzc2lvbihub2RlLCBiaW5kaW5nLCBleHByZXNzaW9uKSB7XG4gICAgcmV0dXJuIHRoaXMuYXBwZW5kKGJpbmRpbmcsIGV4cHJlc3Npb24pO1xuICB9XG4gIHJlZHVjZUJpbmFyeUV4cHJlc3Npb24obm9kZSwgbGVmdCwgcmlnaHQpIHtcbiAgICByZXR1cm4gdGhpcy5hcHBlbmQobGVmdCwgcmlnaHQpO1xuICB9XG4gIHJlZHVjZUJsb2NrKG5vZGUsIHN0YXRlbWVudHMpIHtcbiAgICByZXR1cm4gdGhpcy5mb2xkKHN0YXRlbWVudHMpO1xuICB9XG4gIHJlZHVjZUJsb2NrU3RhdGVtZW50KG5vZGUsIGJsb2NrKSB7XG4gICAgcmV0dXJuIGJsb2NrO1xuICB9XG4gIHJlZHVjZUJyZWFrU3RhdGVtZW50KG5vZGUsIGxhYmVsKSB7XG4gICAgcmV0dXJuIHRoaXMuZnJvbU51bGwobGFiZWwpO1xuICB9XG4gIHJlZHVjZUNhbGxFeHByZXNzaW9uKG5vZGUsIGNhbGxlZSwgYXJncykge1xuICAgIHJldHVybiB0aGlzLmZvbGQoYXJncywgY2FsbGVlKTtcbiAgfVxuICByZWR1Y2VDYXRjaENsYXVzZShub2RlLCBiaW5kaW5nLCBib2R5KSB7XG4gICAgcmV0dXJuIHRoaXMuYXBwZW5kKGJpbmRpbmcsIGJvZHkpO1xuICB9XG4gIHJlZHVjZUNvbXB1dGVkTWVtYmVyRXhwcmVzc2lvbihub2RlLCBvYmplY3QsIGV4cHJlc3Npb24pIHtcbiAgICByZXR1cm4gdGhpcy5hcHBlbmQob2JqZWN0LCBleHByZXNzaW9uKTtcbiAgfVxuICByZWR1Y2VDb25kaXRpb25hbEV4cHJlc3Npb24obm9kZSwgdGVzdCwgY29uc2VxdWVudCwgYWx0ZXJuYXRlKSB7XG4gICAgcmV0dXJuIHRoaXMuYXBwZW5kMyh0ZXN0LCBjb25zZXF1ZW50LCBhbHRlcm5hdGUpO1xuICB9XG4gIHJlZHVjZUNvbnRpbnVlU3RhdGVtZW50KG5vZGUsIGxhYmVsKSB7XG4gICAgcmV0dXJuIHRoaXMuZnJvbU51bGwobGFiZWwpO1xuICB9XG4gIHJlZHVjZURhdGFQcm9wZXJ0eShub2RlLCBuYW1lLCBleHByZXNzaW9uKSB7XG4gICAgcmV0dXJuIHRoaXMuYXBwZW5kKG5hbWUsIGV4cHJlc3Npb24pO1xuICB9XG4gIHJlZHVjZURlYnVnZ2VyU3RhdGVtZW50KG5vZGUpIHtcbiAgICByZXR1cm4gdGhpcy5pZGVudGl0eSgpO1xuICB9XG4gIHJlZHVjZURvV2hpbGVTdGF0ZW1lbnQobm9kZSwgYm9keSwgdGVzdCkge1xuICAgIHJldHVybiB0aGlzLmFwcGVuZChib2R5LCB0ZXN0KTtcbiAgfVxuICByZWR1Y2VFbXB0eVN0YXRlbWVudChub2RlKSB7XG4gICAgcmV0dXJuIHRoaXMuaWRlbnRpdHkoKTtcbiAgfVxuICByZWR1Y2VFeHByZXNzaW9uU3RhdGVtZW50KG5vZGUsIGV4cHJlc3Npb24pIHtcbiAgICByZXR1cm4gZXhwcmVzc2lvbjtcbiAgfVxuICByZWR1Y2VGb3JJblN0YXRlbWVudChub2RlLCBsZWZ0LCByaWdodCwgYm9keSkge1xuICAgIHJldHVybiB0aGlzLmFwcGVuZDMobGVmdCwgcmlnaHQsIGJvZHkpO1xuICB9XG4gIHJlZHVjZUZvclN0YXRlbWVudChub2RlLCBpbml0LCB0ZXN0LCB1cGRhdGUsIGJvZHkpIHtcbiAgICByZXR1cm4gdGhpcy5hcHBlbmQ0KHRoaXMuZnJvbU51bGwoaW5pdCksIHRoaXMuZnJvbU51bGwodGVzdCksIHRoaXMuZnJvbU51bGwodXBkYXRlKSwgYm9keSk7XG4gIH1cbiAgcmVkdWNlRnVuY3Rpb25Cb2R5KG5vZGUsIGRpcmVjdGl2ZXMsIHN0YXRlbWVudHMpIHtcbiAgICByZXR1cm4gdGhpcy5hcHBlbmQodGhpcy5mb2xkKGRpcmVjdGl2ZXMpLCB0aGlzLmZvbGQoc3RhdGVtZW50cykpO1xuICB9XG4gIHJlZHVjZUZ1bmN0aW9uRGVjbGFyYXRpb24obm9kZSwgbmFtZSwgcGFyYW1ldGVycywgYm9keSkge1xuICAgIHJldHVybiB0aGlzLmFwcGVuZCh0aGlzLmZvbGQocGFyYW1ldGVycywgbmFtZSksIGJvZHkpO1xuICB9XG4gIHJlZHVjZUZ1bmN0aW9uRXhwcmVzc2lvbihub2RlLCBuYW1lLCBwYXJhbWV0ZXJzLCBib2R5KSB7XG4gICAgcmV0dXJuIHRoaXMuYXBwZW5kKHRoaXMuZm9sZChwYXJhbWV0ZXJzLCB0aGlzLmZyb21OdWxsKG5hbWUpKSwgYm9keSk7XG4gIH1cbiAgcmVkdWNlR2V0dGVyKG5vZGUsIG5hbWUsIGJvZHkpIHtcbiAgICByZXR1cm4gdGhpcy5hcHBlbmQobmFtZSwgYm9keSk7XG4gIH1cbiAgcmVkdWNlSWRlbnRpZmllcihub2RlKSB7XG4gICAgcmV0dXJuIHRoaXMuaWRlbnRpdHkoKTtcbiAgfVxuICByZWR1Y2VJZGVudGlmaWVyRXhwcmVzc2lvbihub2RlLCBuYW1lKSB7XG4gICAgcmV0dXJuIG5hbWU7XG4gIH1cbiAgcmVkdWNlSWZTdGF0ZW1lbnQobm9kZSwgdGVzdCwgY29uc2VxdWVudCwgYWx0ZXJuYXRlKSB7XG4gICAgcmV0dXJuIHRoaXMuYXBwZW5kMyh0ZXN0LCBjb25zZXF1ZW50LCB0aGlzLmZyb21OdWxsKGFsdGVybmF0ZSkpO1xuICB9XG4gIHJlZHVjZUxhYmVsZWRTdGF0ZW1lbnQobm9kZSwgbGFiZWwsIGJvZHkpIHtcbiAgICByZXR1cm4gdGhpcy5hcHBlbmQobGFiZWwsIGJvZHkpO1xuICB9XG4gIHJlZHVjZUxpdGVyYWxCb29sZWFuRXhwcmVzc2lvbihub2RlKSB7XG4gICAgcmV0dXJuIHRoaXMuaWRlbnRpdHkoKTtcbiAgfVxuICByZWR1Y2VMaXRlcmFsTnVsbEV4cHJlc3Npb24obm9kZSkge1xuICAgIHJldHVybiB0aGlzLmlkZW50aXR5KCk7XG4gIH1cbiAgcmVkdWNlTGl0ZXJhbE51bWVyaWNFeHByZXNzaW9uKG5vZGUpIHtcbiAgICByZXR1cm4gdGhpcy5pZGVudGl0eSgpO1xuICB9XG4gIHJlZHVjZUxpdGVyYWxSZWdFeHBFeHByZXNzaW9uKG5vZGUpIHtcbiAgICByZXR1cm4gdGhpcy5pZGVudGl0eSgpO1xuICB9XG4gIHJlZHVjZUxpdGVyYWxTdHJpbmdFeHByZXNzaW9uKG5vZGUpIHtcbiAgICByZXR1cm4gdGhpcy5pZGVudGl0eSgpO1xuICB9XG4gIHJlZHVjZU5ld0V4cHJlc3Npb24obm9kZSwgY2FsbGVlLCBhcmdzKSB7XG4gICAgcmV0dXJuIHRoaXMuZm9sZChhcmdzLCBjYWxsZWUpO1xuICB9XG4gIHJlZHVjZU9iamVjdEV4cHJlc3Npb24obm9kZSwgcHJvcGVydGllcykge1xuICAgIHJldHVybiB0aGlzLmZvbGQocHJvcGVydGllcyk7XG4gIH1cbiAgcmVkdWNlUG9zdGZpeEV4cHJlc3Npb24obm9kZSwgb3BlcmFuZCkge1xuICAgIHJldHVybiBvcGVyYW5kO1xuICB9XG4gIHJlZHVjZVByZWZpeEV4cHJlc3Npb24obm9kZSwgb3BlcmFuZCkge1xuICAgIHJldHVybiBvcGVyYW5kO1xuICB9XG4gIHJlZHVjZVByb3BlcnR5TmFtZShub2RlKSB7XG4gICAgcmV0dXJuIHRoaXMuaWRlbnRpdHkoKTtcbiAgfVxuICByZWR1Y2VSZXR1cm5TdGF0ZW1lbnQobm9kZSwgZXhwcmVzc2lvbikge1xuICAgIHJldHVybiB0aGlzLmZyb21OdWxsKGV4cHJlc3Npb24pO1xuICB9XG4gIHJlZHVjZVNjcmlwdChub2RlLCBib2R5KSB7XG4gICAgcmV0dXJuIGJvZHk7XG4gIH1cbiAgcmVkdWNlU2V0dGVyKG5vZGUsIG5hbWUsIHBhcmFtZXRlciwgYm9keSkge1xuICAgIHJldHVybiB0aGlzLmFwcGVuZDMobmFtZSwgcGFyYW1ldGVyLCBib2R5KTtcbiAgfVxuICByZWR1Y2VTdGF0aWNNZW1iZXJFeHByZXNzaW9uKG5vZGUsIG9iamVjdCwgcHJvcGVydHkpIHtcbiAgICByZXR1cm4gdGhpcy5hcHBlbmQob2JqZWN0LCBwcm9wZXJ0eSk7XG4gIH1cbiAgcmVkdWNlU3dpdGNoQ2FzZShub2RlLCB0ZXN0LCBjb25zZXF1ZW50KSB7XG4gICAgcmV0dXJuIHRoaXMuZm9sZChjb25zZXF1ZW50LCB0ZXN0KTtcbiAgfVxuICByZWR1Y2VTd2l0Y2hEZWZhdWx0KG5vZGUsIGNvbnNlcXVlbnQpIHtcbiAgICByZXR1cm4gdGhpcy5mb2xkKGNvbnNlcXVlbnQpO1xuICB9XG4gIHJlZHVjZVN3aXRjaFN0YXRlbWVudChub2RlLCBkaXNjcmltaW5hbnQsIGNhc2VzKSB7XG4gICAgcmV0dXJuIHRoaXMuZm9sZChjYXNlcywgZGlzY3JpbWluYW50KTtcbiAgfVxuICByZWR1Y2VTd2l0Y2hTdGF0ZW1lbnRXaXRoRGVmYXVsdChub2RlLCBkaXNjcmltaW5hbnQsIHByZURlZmF1bHRDYXNlcywgZGVmYXVsdENhc2UsIHBvc3REZWZhdWx0Q2FzZXMpIHtcbiAgICByZXR1cm4gdGhpcy5hcHBlbmQ0KGRpc2NyaW1pbmFudCwgdGhpcy5mb2xkKHByZURlZmF1bHRDYXNlcyksIGRlZmF1bHRDYXNlLCB0aGlzLmZvbGQocG9zdERlZmF1bHRDYXNlcykpO1xuICB9XG4gIHJlZHVjZVRoaXNFeHByZXNzaW9uKG5vZGUpIHtcbiAgICByZXR1cm4gdGhpcy5pZGVudGl0eSgpO1xuICB9XG4gIHJlZHVjZVRocm93U3RhdGVtZW50KG5vZGUsIGV4cHJlc3Npb24pIHtcbiAgICByZXR1cm4gdGhpcy5mcm9tTnVsbChleHByZXNzaW9uKTtcbiAgfVxuICByZWR1Y2VUcnlDYXRjaFN0YXRlbWVudChub2RlLCBibG9jaywgY2F0Y2hDbGF1c2UpIHtcbiAgICByZXR1cm4gdGhpcy5hcHBlbmQoYmxvY2ssIGNhdGNoQ2xhdXNlKTtcbiAgfVxuICByZWR1Y2VUcnlGaW5hbGx5U3RhdGVtZW50KG5vZGUsIGJsb2NrLCBjYXRjaENsYXVzZSwgZmluYWxpemVyKSB7XG4gICAgcmV0dXJuIHRoaXMuYXBwZW5kMyhibG9jaywgdGhpcy5mcm9tTnVsbChjYXRjaENsYXVzZSksIGZpbmFsaXplcik7XG4gIH1cbiAgcmVkdWNlVW5rbm93bkRpcmVjdGl2ZShub2RlKSB7XG4gICAgcmV0dXJuIHRoaXMuaWRlbnRpdHkoKTtcbiAgfVxuICByZWR1Y2VVc2VTdHJpY3REaXJlY3RpdmUobm9kZSkge1xuICAgIHJldHVybiB0aGlzLmlkZW50aXR5KCk7XG4gIH1cbiAgcmVkdWNlVmFyaWFibGVEZWNsYXJhdGlvbihub2RlLCBkZWNsYXJhdG9ycykge1xuICAgIHJldHVybiB0aGlzLmZvbGQoZGVjbGFyYXRvcnMpO1xuICB9XG4gIHJlZHVjZVZhcmlhYmxlRGVjbGFyYXRpb25TdGF0ZW1lbnQobm9kZSwgZGVjbGFyYXRpb24pIHtcbiAgICByZXR1cm4gZGVjbGFyYXRpb247XG4gIH1cbiAgcmVkdWNlVmFyaWFibGVEZWNsYXJhdG9yKG5vZGUsIGJpbmRpbmcsIGluaXQpIHtcbiAgICByZXR1cm4gdGhpcy5hcHBlbmQoYmluZGluZywgdGhpcy5mcm9tTnVsbChpbml0KSk7XG4gIH1cbiAgcmVkdWNlV2hpbGVTdGF0ZW1lbnQobm9kZSwgdGVzdCwgYm9keSkge1xuICAgIHJldHVybiB0aGlzLmFwcGVuZCh0ZXN0LCBib2R5KTtcbiAgfVxuICByZWR1Y2VXaXRoU3RhdGVtZW50KG5vZGUsIG9iamVjdCwgYm9keSkge1xuICAgIHJldHVybiB0aGlzLmFwcGVuZChvYmplY3QsIGJvZHkpO1xuICB9XG59XG4iXX0=